# Rust to WASM Example: Add and Greet

This example demonstrates how to compile Rust functions to WebAssembly (WASM) and call them from JavaScript in a web browser using `wasm-bindgen` and `wasm-pack`.

The example includes two simple Rust functions:
- `add(a: i32, b: i32) -> i32`: Takes two integers and returns their sum.
- `greet(name: &str) -> String`: Takes a string slice (name) and returns a greeting message.

## Files

- `rust_src/`: This directory contains the Rust library source code.
    - `Cargo.toml`: The Rust package manifest. It defines dependencies, including `wasm-bindgen`, and configures the library to be compiled as a `cdylib` (dynamic system library, suitable for WASM).
    - `src/lib.rs`: Contains the Rust source code for the `add` and `greet` functions, annotated with `#[wasm_bindgen]` to make them accessible from JavaScript.
- `index.html`: The main HTML page that loads the WASM module and provides a simple UI to interact with the Rust functions.
- `script.js`: JavaScript code that handles loading the WASM module (generated by `wasm-pack`), user input, calling the exported Rust functions, and displaying the results.
- `pkg/` (Generated): This directory is created by the `wasm-pack build` command. It contains:
    - `rust_wasm_example.wasm`: The compiled WebAssembly module. (The name `rust_wasm_example` is taken from `Cargo.toml`)
    - `rust_wasm_example.js`: JavaScript glue code generated by `wasm-bindgen` to load and interface with the WASM module.
    - `package.json`: Standard npm package file.
    - other helper files.

## Prerequisites

1.  **Rust Toolchain**: Install Rust (if you haven't already) from [rust-lang.org](https://www.rust-lang.org/tools/install).
2.  **`wasm-pack`**: Install `wasm-pack`, a tool for building and packaging Rust crates that target WebAssembly.
    ```bash
    cargo install wasm-pack
    ```
    Refer to the [official wasm-pack documentation](https://rustwasm.github.io/wasm-pack/installer/) for more installation options.

## How to Build

1.  Navigate to the Rust example directory:
    ```bash
    cd examples/wasm/rust_example
    ```
2.  Run `wasm-pack` to build the project. The `--target web` flag is important as it generates code suitable for direct use in web browsers without requiring a bundler like Webpack for this simple example.
    ```bash
    wasm-pack build --target web ./rust_src
    ```
    This command compiles your Rust code in `rust_src/` to WebAssembly, generates the JavaScript bindings, and places them in a new directory called `pkg` inside `examples/wasm/rust_example/`.

    If you inspect the `pkg` directory, you'll find `rust_wasm_example.js` and `rust_wasm_example_bg.wasm` (the actual WASM binary, name might vary slightly based on your `Cargo.toml` name).

## How to Run

1.  After successfully building the WASM module (the `pkg` directory is present with `rust_wasm_example.js` and the `.wasm` file), you need to serve the `examples/wasm/rust_example/` directory using a local web server. Browsers typically restrict loading WASM files directly from the local file system due to security policies.

2.  A simple way to start a web server (if you have Python 3) from the `examples/wasm/rust_example/` directory is:
    ```bash
    python -m http.server
    ```
    Or for Python 2:
    ```bash
    python -m SimpleHTTPServer
    ```
    This will usually serve files from the current directory at `http://localhost:8000`.

3.  Open your web browser and navigate to `http://localhost:8000/index.html` (or the appropriate URL if your server uses a different port).

4.  You should see input fields and buttons for both the "add" and "greet" functions. Interact with them to see the results computed by the Rust WASM module.

## Notes

- The `#[wasm_bindgen]` attribute in `rust_src/src/lib.rs` is crucial for exposing Rust functions to JavaScript.
- `Cargo.toml` specifies `crate-type = ["cdylib", "rlib"]`. `cdylib` is for the WASM binary, and `rlib` allows it to be used as a normal Rust library too.
- The `script.js` uses an ES6 dynamic `import()` to load the JavaScript module from the `pkg` directory. This module handles the instantiation of the WASM binary.
- The `wasm-pack build --target web` command creates output that's easy to integrate into web applications without complex bundler configurations for simple cases. For more complex applications, other `wasm-pack` targets and bundlers like Webpack or Parcel might be used.
